@{
	ViewData["Title"] = "Customer Record";
}

<div class="form-inline">
    <button role="button" class="btn btn-primary">Add</button>
    <div class="input-group col-3">
        <input type="search" class="form-control" id="search-customer" placeholder="Search customer" />
        <div class="input-group-append">
            <button class="btn btn-outline-secondary">Search</button>
        </div>
    </div>
</div>
<hr />

<div id="search-result" class="d-none"></div>

<script>
    $(function () {

        var ajax;
        $("#search-customer").on("keypress", function () {
            setTimeout(function () {
                var term = $("#search-customer").val();
                if (ajax != undefined)
                    ajax.abort();
                ajax = $.ajax({
                    url: "/CustomerRecord/SearchCustomer",
                    data: {term:term},
                    type: "post",
                    dataType: "json",
                    success: function (data) {
                        ajax = undefined;
                        Result(data);
                    }
                });
            }, 1);
        });

		function Result(customers) {
			$("#search-result").html('');
			for (i in customers) {
                CustomerFound(customers[i]);
			}
        }

        function CustomerFound(customer) {
            var html = `
<a class="customer-found" href="#">
    <div class="search-item">
        <span>${customer.Name}</span>
    </div>
</a>`;
            var item = $(html);
            $("#search-result").append(item).removeClass("d-none");
            $(item).click(function () {
                $("#search-result").html('').addClass("d-none");
                CustomerRecord(customer);
            });
        }

        function CustomerRecord(customer) {
            console.log(customer);
		}

    });
</script>